<div *ngIf="loading" class="global-spinner-container">
  <mat-spinner [diameter]="50"></mat-spinner>
</div>
<div class="register-pet-container">
    <h1>Cadastro de Pet</h1>
    <form [formGroup]="petForm" (ngSubmit)="onSubmit()">
      <div class="form-sections">

        <!-- Seção de Busca de Cliente -->
        <div class="form-section">
          <h3>Buscar Cliente</h3>

          <!-- CPF do Cliente -->
          <div class="form-group" [ngClass]="{'has-error': petForm.get('cpf')?.touched && petForm.get('cpf')?.invalid}">
            <label for="cpf">
              <mat-icon class="label-icon">person_search</mat-icon>
              CPF do Cliente
            </label>
            <div class="input-with-icon">
              <input id="cpf" formControlName="cpf" type="text" placeholder="Digite o CPF" mask="000.000.000-00">
              <button type="button" class="btn-icon" (click)="searchClientByCpf()" matTooltip="Consultar Dono do pet">
                <mat-icon>search</mat-icon>
              </button>
            </div>
            <div *ngIf="petForm.get('cpf')?.touched && petForm.get('cpf')?.invalid" class="error-message">
              CPF é obrigatório.
            </div>
          </div>

          <!-- Nome do Cliente -->
          <div class="form-group">
            <label for="clientName">
              <mat-icon class="label-icon">person</mat-icon>
              Nome do Cliente
            </label>
            <div class="input-with-icon">
              <input id="clientName" formControlName="clientName" type="text" isdisabled>
            </div>
          </div>
        </div>

        <!-- Seção de Informações do Pet -->
        <div class="form-section">
          <h3>Informações do Pet</h3>

          <!-- Nome do Pet -->
          <div class="form-group" [ngClass]="{'has-error': petForm.get('name')?.touched && petForm.get('name')?.invalid}">
            <label for="name">
              <mat-icon class="label-icon">pets</mat-icon>
              Nome do Pet <span class="required">*</span>
            </label>
            <div class="input-with-icon">
              <input id="name" formControlName="name" type="text" placeholder="Nome do Pet">
            </div>
            <div *ngIf="petForm.get('name')?.touched && petForm.get('name')?.invalid" class="error-message">
              Nome do pet é obrigatório.
            </div>
          </div>

          <!-- Raça -->
          <div class="form-group" [ngClass]="{'has-error': petForm.get('race')?.touched && petForm.get('race')?.invalid}">
            <label for="race">
              <mat-icon class="label-icon">category</mat-icon>
              Raça <span class="required">*</span>
            </label>
            <div class="input-with-icon">
              <select id="race" formControlName="race">
                <option *ngFor="let race of races" [value]="race">{{ race }}</option>
              </select>
            </div>
            <div *ngIf="petForm.get('race')?.touched && petForm.get('race')?.invalid" class="error-message">
              Raça é obrigatória.
            </div>
          </div>

          <!-- Porte -->
          <div class="form-group" [ngClass]="{'has-error': petForm.get('size')?.touched && petForm.get('size')?.invalid}">
            <label for="size">
              <mat-icon class="label-icon">straighten</mat-icon>
              Porte <span class="required">*</span>
            </label>
            <div class="input-with-icon">
              <select id="size" formControlName="size">
                <option *ngFor="let size of sizes" [value]="size">{{ size }}</option>
              </select>
            </div>
            <div *ngIf="petForm.get('size')?.touched && petForm.get('size')?.invalid" class="error-message">
              Porte é obrigatório.
            </div>
          </div>
        </div>
      </div>

      <!-- Botão de Cadastrar -->
      <button type="submit" class="btn-save" [disabled]="petForm.invalid || loading">Cadastrar Pet
      </button>
    </form>
  </div>
