<div class="loading-overlay" *ngIf="loading">
  <mat-progress-spinner
    class="loading-spinner"
    [diameter]="50"
    mode="indeterminate">
  </mat-progress-spinner>
  <p>Carregando agendamentos...</p>
</div>

<div class="consult-scheduling-container">
  <h2>Agendamentos do Dia</h2>

  <!-- Card para Agendamentos Agendados -->
  <mat-card class="agendamentos-card">
    <mat-card-title>Agendados</mat-card-title>
    <mat-card-content>
      <div class="table-responsive">
        <table mat-table [dataSource]="schedulingsAgendados" class="mat-elevation-z8" *ngIf="schedulingsAgendados.length > 0">
          <!-- Nome do Cliente -->
          <ng-container matColumnDef="clientName">
            <th mat-header-cell *matHeaderCellDef> Nome do Cliente </th>
            <td mat-cell *matCellDef="let scheduling"> {{ scheduling?.pet?.client?.name || 'N/A' }} </td>
          </ng-container>

          <!-- Nome do Pet -->
          <ng-container matColumnDef="petName">
            <th mat-header-cell *matHeaderCellDef> Nome do Pet </th>
            <td mat-cell *matCellDef="let scheduling"> {{ scheduling?.pet?.name || 'N/A' }} </td>
          </ng-container>

          <!-- Serviço -->
          <ng-container matColumnDef="service">
            <th mat-header-cell *matHeaderCellDef> Serviço(s) </th>
            <td mat-cell *matCellDef="let scheduling">
              <ul class="no-bullets">
                <li *ngFor="let service of scheduling?.service">{{ service?.name || 'N/A' }}</li>
              </ul>
            </td>
          </ng-container>

          <!-- Nome do Funcionário -->
          <ng-container matColumnDef="employeeName">
            <th mat-header-cell *matHeaderCellDef> Funcionário Responsável </th>
            <td mat-cell *matCellDef="let scheduling">
              <ul class="no-bullets">
                <li *ngFor="let service of scheduling?.service">{{ service?.employee?.name || 'N/A' }}</li>
              </ul>
            </td>
          </ng-container>

          <!-- Data -->
          <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef> Data </th>
            <td mat-cell *matCellDef="let scheduling"> {{ scheduling?.date | date: 'dd/MM/yyyy' }} </td>
          </ng-container>

          <!-- Hora -->
          <ng-container matColumnDef="time">
            <th mat-header-cell *matHeaderCellDef> Hora </th>
            <td mat-cell *matCellDef="let scheduling"> {{ scheduling?.time || 'N/A' }} </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="['clientName', 'petName', 'service', 'employeeName', 'date', 'time']"></tr>
          <tr mat-row *matRowDef="let row; columns: ['clientName', 'petName', 'service', 'employeeName', 'date', 'time']"></tr>
        </table>
      </div>
      <div class="no-schedulings-message" *ngIf="schedulingsAgendados.length === 0">
        Nenhum agendamento agendado no momento.
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Card para Agendamentos Em Andamento -->
  <mat-card class="agendamentos-card">
    <mat-card-title>Em Andamento</mat-card-title>
    <mat-card-content>
      <div class="table-responsive">
        <table mat-table [dataSource]="schedulingsEmAndamento" class="mat-elevation-z8" *ngIf="schedulingsEmAndamento.length > 0">
          <!-- Nome do Cliente -->
          <ng-container matColumnDef="clientName">
            <th mat-header-cell *matHeaderCellDef> Nome do Cliente </th>
            <td mat-cell *matCellDef="let scheduling"> {{ scheduling?.pet?.client?.name || 'N/A' }} </td>
          </ng-container>

          <!-- Nome do Pet -->
          <ng-container matColumnDef="petName">
            <th mat-header-cell *matHeaderCellDef> Nome do Pet </th>
            <td mat-cell *matCellDef="let scheduling"> {{ scheduling?.pet?.name || 'N/A' }} </td>
          </ng-container>

          <!-- Serviço -->
          <ng-container matColumnDef="service">
            <th mat-header-cell *matHeaderCellDef> Serviço(s) </th>
            <td mat-cell *matCellDef="let scheduling">
              <ul class="no-bullets">
                <li *ngFor="let service of scheduling?.service">{{ service?.name || 'N/A' }}</li>
              </ul>
            </td>
          </ng-container>

          <!-- Nome do Funcionário -->
          <ng-container matColumnDef="employeeName">
            <th mat-header-cell *matHeaderCellDef> Funcionário Responsável </th>
            <td mat-cell *matCellDef="let scheduling">
              <ul class="no-bullets">
                <li *ngFor="let service of scheduling?.service">{{ service?.employee?.name || 'N/A' }}</li>
              </ul>
            </td>
          </ng-container>

          <!-- Data -->
          <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef> Data </th>
            <td mat-cell *matCellDef="let scheduling"> {{ scheduling?.date | date: 'dd/MM/yyyy' }} </td>
          </ng-container>

          <!-- Hora -->
          <ng-container matColumnDef="time">
            <th mat-header-cell *matHeaderCellDef> Hora </th>
            <td mat-cell *matCellDef="let scheduling"> {{ scheduling?.time || 'N/A' }} </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="['clientName', 'petName', 'service', 'employeeName', 'date', 'time']"></tr>
          <tr mat-row *matRowDef="let row; columns: ['clientName', 'petName', 'service', 'employeeName', 'date', 'time']"></tr>
        </table>
      </div>
      <div class="no-schedulings-message" *ngIf="schedulingsEmAndamento.length === 0">
        Nenhum agendamento em andamento no momento.
      </div>
    </mat-card-content>
  </mat-card>
</div>
